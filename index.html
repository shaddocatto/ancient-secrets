<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amber RPG Character Builder</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Ancient Secrets</h1>
        <p class="subtitle">Character Creation System - 60 Points</p>
        
        <div class="points-display">
            <h3>Good Stuff</h3>
            <div class="points-remaining" id="pointsRemaining">60</div>
            <div id="pointsStatus"></div>
            <div class="save-status" id="saveStatus">Auto-saving...</div>
        </div>

        <!-- Character management: load, save, import/export multiple characters -->
        <div class="section" id="characterManagement">
            <h2>Manage Characters</h2>
            <div class="character-management-row">
                <label for="characterSelect">Current Character:</label>
                <select id="characterSelect"></select>
                <button onclick="newCharacter()">New</button>
                <button onclick="document.getElementById('importFileInput').click()">Import</button>
                <input type="file" id="importFileInput" accept=".json" style="display: none;" onchange="importCharacterJSON(event)">
                <button onclick="exportCharacterJSON()">Export JSON</button>
                <button onclick="deleteCharacter()">Delete</button>
                <input type="file" id="importFile" accept=".json" style="display:none">
            </div>
            <div id="importStatus" style="margin-top: 10px; display: none;"></div>
        </div>

        <!-- Character and Player Info -->
        <div class="section">
            <h2>Character Information</h2>
            <div class="form-group">
                <label for="characterName">Character Name:</label>
                <input type="text" id="characterName" placeholder="Enter character name">
            </div>
            <div class="form-group">
                <label for="playerName">Player Name:</label>
                <input type="text" id="playerName" placeholder="Enter player name">
            </div>
        </div>

        <!-- Heritage Selection -->
        <div class="section">
            <h2>Heritage</h2>
            <div class="form-group">
                <label for="heritage">Choose your Heritage:</label>
                <select id="heritage" onchange="updateHeritage()">
                    <option value="">Select Heritage...</option>
                    <option value="recognized-amber">Recognized Amber (Free - Court position, Blood Curse, Slow Regeneration, Pattern Adept)</option>
                    <option value="unrecognized-amber">Unrecognized Amber (+5 pts - Blood Curse, Slow Regeneration, see GM)</option>
                    <option value="chaos">Chaos (+2 pts - Shapeshifting free)</option>
                    <option value="both">Both Amber and Chaos (-3 pts - All benefits)</option>
                    <option value="other">Other (+6 pts - Work with GM)</option>
                </select>
                <div id="heritageInfo" class="heritage-info" style="display: none;"></div>
            </div>
        </div>

        <!-- Character Aspects -->
        <div class="section">
            <h2>Character Aspects</h2>
            <div class="form-group">
                <label for="concept">Concept (Who are you? What do you do?):</label>
                <input type="text" id="concept" placeholder="e.g., Wandering swordsman seeking redemption">
            </div>
            <div class="form-group">
                <label for="position">Position (What are you to the family and court?):</label>
                <input type="text" id="position" placeholder="e.g., Bastard child seeking recognition">
            </div>
            <div class="form-group">
                <label for="trouble">Trouble (What gets you into trouble?):</label>
                <input type="text" id="trouble" placeholder="e.g., Cannot resist a challenge to my honor">
            </div>
            <div class="form-group">
                <label for="secret">Secret (What are you hiding? Free invoke when revealed):</label>
                <input type="text" id="secret" placeholder="e.g., I am the true heir to the throne of a fallen Shadow">
            </div>
        </div>

        <!-- Skills -->
        <div class="section">
            <h2>Skills (Max +12)</h2>
            <p style="margin-bottom: 20px; color: #cccccc;">Costs 1 point for each +1 ranked above Amber (0). Human (-3), Chaos (-1), Amber (0), and above.</p>
            <div class="skill-container">
                <div class="skill-item">
                    <label for="strength">Strength</label>
                    <div class="skill-description">Physique, athletics, toughness, hand-to-hand combat</div>
                    <input type="number" id="strength" min="-3" max="12" value="0" onchange="updateSkills()">
                </div>
                <div class="skill-item">
                    <label for="warfare">Warfare</label>
                    <div class="skill-description">Leadership, tactics, strategy, vehicles, riding, weapons combat</div>
                    <input type="number" id="warfare" min="-3" max="12" value="0" onchange="updateSkills()">
                </div>
                <div class="skill-item">
                    <label for="psyche">Psyche</label>
                    <div class="skill-description">Focus, discipline, will, empathy, mystical power and potential</div>
                    <input type="number" id="psyche" min="-3" max="12" value="0" onchange="updateSkills()">
                </div>
                <div class="skill-item">
                    <label for="endurance">Endurance</label>
                    <div class="skill-description">Resilience, tenacity, physical/mental reserves, stress</div>
                    <input type="number" id="endurance" min="-3" max="12" value="0" onchange="updateSkills()">
                </div>
                <div class="skill-item">
                    <label for="status">Status</label>
                    <div class="skill-description">Contacts, charm, convincing, reputation, resources, dominion</div>
                    <input type="number" id="status" min="-3" max="12" value="0" onchange="updateSkills()">
                </div>
                <div class="skill-item">
                    <label for="intrigue">Intrigue</label>
                    <div class="skill-description">Deceit, espionage, secrets, manipulation, leverage, skulduggery</div>
                    <input type="number" id="intrigue" min="-3" max="12" value="0" onchange="updateSkills()">
                </div>
                <div class="skill-item">
                    <label for="hunting">Hunting</label>
                    <div class="skill-description">Train Animal, survival, tracking, riding, ambush, hunting weapons</div>
                    <input type="number" id="hunting" min="-3" max="12" value="0" onchange="updateSkills()">
                </div>
                <div class="skill-item">
                    <label for="lore">Lore</label>
                    <div class="skill-description">Knowledge, occult understanding, crafting, engineering, medicine</div>
                    <input type="number" id="lore" min="-3" max="12" value="0" onchange="updateSkills()">
                </div>
            </div>
        </div>

        <!-- Powers -->
        <div class="section">
            <h2>Powers</h2>
            <p style="margin-bottom: 20px; color: #cccccc;">All Powers require appropriate Heritage and/or Permission Aspect to access.</p>
            <div class="powers-grid">
                <!-- Powers of Order -->
                <div class="power-category">
                    <h3>Powers of Order</h3>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="pattern-adept" onchange="updatePowers()" data-cost="5" data-prereq="">
                            <span class="power-cost" id="pattern-adept-cost">5</span>
                            Pattern Adept
                        </label>
                        <div class="power-description">Requires: Amber Heritage; Amber (0) Endurance. Shadow Travel, Hellride, Shadow of Desire, Resources, Manipulate Probability, Pattern Psychic Defense</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="advanced-pattern" onchange="updatePowers()" data-cost="7" data-prereq="pattern-adept" data-credit="pattern-adept:-5">
                            <span class="power-cost" id="advanced-pattern-cost">7</span>
                            Advanced Pattern Adept
                        </label>
                        <div class="power-description">Requires: Pattern Adept; Amber (0) Psyche. Pattern Lens, Mold Shadow, Walk the Pattern of the mind, Edit Pattern</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="warden-stair" onchange="updatePowers()" data-cost="1" data-credit="pattern-adept:-1">
                            <span class="power-cost" id="warden-stair-cost">1</span>
                            Warden of the Grand Stair
                        </label>
                        <div class="power-description">Requires: Amber (0) Psyche. Open and Close Doors, Wayfinding, Piercing Veil, Exegesis</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="master-stair" onchange="updatePowers()" data-cost="3" data-prereq="warden-stair" data-credit="warden-stair:-1">
                            <span class="power-cost" id="master-stair-cost">3</span>
                            Master of the Grand Stair
                        </label>
                        <div class="power-description">Requires: Warden; Amber (0) Psyche, Chaos (-1) Endurance. Ward Doors, Control Doors, Making Keys, Advanced abilities</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="eidolon-mastery" onchange="updatePowers()" data-cost="8" data-credit="pattern-adept:-4,advanced-pattern:-6">
                            <span class="power-cost" id="eidolon-mastery-cost">8</span>
                            Eidolon Mastery
                        </label>
                        <div class="power-description">Requires: Amber (0) Psyche. Immortality, Edit reality, Guide reality, Sanctification</div>
                    </div>
                </div>

                <!-- Powers of Chaos -->
                <div class="power-category">
                    <h3>Powers of Chaos</h3>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="shapeshifting" onchange="updatePowers()" data-cost="3" data-prereq="">
                            <span class="power-cost" id="shapeshifting-cost">3</span>
                            Shapeshifting
                        </label>
                        <div class="power-description">Requires: Chaos Heritage; Chaos (-1) Strength and Endurance. Assume Known Shape, Automatic Shifting, Demon Form, Healing, Primal Form</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="advanced-shapeshifting" onchange="updatePowers()" data-cost="6" data-prereq="shapeshifting" data-credit="shapeshifting:-3">
                            <span class="power-cost" id="advanced-shapeshifting-cost">6</span>
                            Advanced Shapeshifting
                        </label>
                        <div class="power-description">Requires: Shapeshifting; Amber (0) Strength, Endurance, Psyche. Duplicate Other, Shape Aura, Shape Other</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="logrus-master" onchange="updatePowers()" data-cost="4" data-prereq="shapeshifting">
                            <span class="power-cost" id="logrus-master-cost">4</span>
                            Logrus Master
                        </label>
                        <div class="power-description">Requires: Shapeshifting; Amber (0) Psyche, Chaos (-1) Endurance. Logrus Tendrils, Hang Spells, Find in Shadow</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="advanced-logrus" onchange="updatePowers()" data-cost="7" data-prereq="logrus-master" data-credit="logrus-master:-4">
                            <span class="power-cost" id="advanced-logrus-cost">7</span>
                            Advanced Logrus Master
                        </label>
                        <div class="power-description">Requires: Logrus Master; Amber (0) Psyche and Endurance. Alter Shadow, Create Primal Chaos, Logrus Healing</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="umbra-mastery" onchange="updatePowers()" data-cost="8" data-credit="shapeshifting:-2,logrus-master:-3,advanced-logrus:-5">
                            <span class="power-cost" id="umbra-mastery-cost">8</span>
                            Umbra Mastery
                        </label>
                        <div class="power-description">Requires: Amber (0) Psyche. Perceiving Umbra, Control Reality, Evolution, Immortality, Regeneration, Identify Door, Force Door Open</div>
                    </div>
                </div>

                <!-- Powers of Art -->
                <div class="power-category">
                    <h3>Powers of Art</h3>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="trump-artist" onchange="updatePowers()" data-cost="4" data-prereq="">
                            <span class="power-cost" id="trump-artist-cost">4</span>
                            Trump Artist
                        </label>
                        <div class="power-description">Requires: Chaos (-1) Psyche. Create Trump, Identify Trump, Imbue Trump Artifacts, Trump Defense</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="advanced-trump" onchange="updatePowers()" data-cost="6" data-prereq="trump-artist" data-credit="trump-artist:-2">
                            <span class="power-cost" id="advanced-trump-cost">6</span>
                            Advanced Trump Artist
                        </label>
                        <div class="power-description">Requires: Trump Artist; Amber (0) Psyche. Trump Gate, Trump Jamming, Trump Memory, Trump Trap</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="wrighting" onchange="updatePowers()" data-cost="4" data-credit="trump-artist:-2,advanced-trump:-3">
                            <span class="power-cost" id="wrighting-cost">4</span>
                            Wrighting
                        </label>
                        <div class="power-description">Requires: Amber (0) Psyche. Create Icon, Impromptu Icon, Defense, Creating Icon-Powered Artifacts</div>
                    </div>
                </div>

                <!-- Powers of Darkness -->
                <div class="power-category">
                    <h3>Powers of Darkness</h3>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="abyssal-lord" onchange="updatePowers()" data-cost="4" data-prereq="">
                            <span class="power-cost" id="abyssal-lord-cost">4</span>
                            Abyssal Lord
                        </label>
                        <div class="power-description">Requires: Abyssal Initiation; Amber (0) Psyche, Chaos (-1) Endurance. Summon/Control Souls/Dead, Abyssal Power, Teleportation</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="abyssal-sovereign" onchange="updatePowers()" data-cost="6" data-prereq="abyssal-lord" data-credit="abyssal-lord:-4">
                            <span class="power-cost" id="abyssal-sovereign-cost">6</span>
                            Abyssal Sovereign
                        </label>
                        <div class="power-description">Requires: Abyssal Lord; Amber (0) Psyche and Endurance. Create Abyssal Constructs, Imbue with Abyssal Power, Soul Jar</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="undershadow-manipulator" onchange="updatePowers()" data-cost="3" data-prereq="">
                            <span class="power-cost" id="undershadow-manipulator-cost">3</span>
                            Undershadow Manipulator
                        </label>
                        <div class="power-description">Requires: Amber (0) Psyche, Chaos (-1) Status. Open Portal, Summon/Bind Undershadow Creatures</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="advanced-undershadow" onchange="updatePowers()" data-cost="5" data-prereq="undershadow-manipulator" data-credit="undershadow-manipulator:-3">
                            <span class="power-cost" id="advanced-undershadow-cost">5</span>
                            Advanced Undershadow Manipulator
                        </label>
                        <div class="power-description">Requires: Undershadow Manipulator; Amber (0) Psyche and Status. Manipulate Undershadow, Imbue Undershadow, Scry Undershadow</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="keeper-void" onchange="updatePowers()" data-cost="4" data-credit="undershadow-manipulator:-1,advanced-undershadow:-2">
                            <span class="power-cost" id="keeper-void-cost">4</span>
                            Keeper of the Void
                        </label>
                        <div class="power-description">Requires: Amber (0) Psyche, Chaos (-1) Endurance. Find rift into Void, Survive Void, Communicate with creatures of the deep, Command Undershadow and Void creatures</div>
                    </div>
                </div>

                <!-- Powers of Magick -->
                <div class="power-category">
                    <h3>Powers of Magick</h3>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="sorcery" onchange="updatePowers()" data-cost="3" data-prereq="">
                            <span class="power-cost" id="sorcery-cost">3</span>
                            Sorcery and Conjuration
                        </label>
                        <div class="power-description">Requires: Chaos (-1) Lore and power source. Develop Spell, Cast Spell, Conjure Shadow, Empowerment, Imbue, Create</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="invocation" onchange="updatePowers()" data-cost="3" data-prereq="" data-credit="sorcery:-1">
                            <span class="power-cost" id="invocation-cost">3</span>
                            Invocation
                        </label>
                        <div class="power-description">Requires: Amber (0) Psyche and Lore. True Name powers (Divine, Call, Summon, Banish, Compel, Bind), Purification</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="runes" onchange="updatePowers()" data-cost="3" data-prereq="">
                            <span class="power-cost" id="runes-cost">3</span>
                            The Runes
                        </label>
                        <div class="power-description">Requires: Ranked (+1) Lore. Enhance/diminish powers, create/break connections, alter local reality</div>
                    </div>
                </div>

                <!-- Powers of the Ancients -->
                <div class="power-category">
                    <h3>Powers of the Ancients</h3>
                    <p style="font-size: 0.8em; color: #EFBF04; margin-bottom: 10px; text-align: center;">GM Approval Required - Enter cost manually</p>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="dominion" onchange="updatePowers()" data-cost="0" data-gm-cost="true">
                            <span class="power-cost gm" id="dominion-cost">GM</span>
                            Dominion
                            <input type="number" class="gm-cost-input" id="dominion-manual-cost" placeholder="Cost" onchange="updateGMPowerCost('dominion')">
                        </label>
                        <div class="power-description">Requires: Ranked (+1) Status. Establish Domain, Empower Domain, Control Domain</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="essence" onchange="updatePowers()" data-cost="0" data-gm-cost="true">
                            <span class="power-cost gm" id="essence-cost">GM</span>
                            Essence
                            <input type="number" class="gm-cost-input" id="essence-manual-cost" placeholder="Cost" onchange="updateGMPowerCost('essence')">
                        </label>
                        <div class="power-description">Requires: Ranked (+1) Endurance. True Form (Invoke, Reveal, Empower), Banner Control</div>
                    </div>
                    <div class="power-item">
                        <label>
                            <input type="checkbox" id="song" onchange="updatePowers()" data-cost="0" data-gm-cost="true">
                            <span class="power-cost gm" id="song-cost">GM</span>
                            The Song
                            <input type="number" class="gm-cost-input" id="song-manual-cost" placeholder="Cost" onchange="updateGMPowerCost('song')">
                        </label>
                        <div class="power-description">Requires: Ranked (+1) Psyche. Hear the Song, Join the Song, Guide the Song, Add to the Song</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Extras -->
        <div class="section">
            <h2>Extras (Optional)</h2>
            <p style="margin-bottom: 20px; color: #cccccc;">GM approval required. Choose Simple (name + aspect + invokes) or Custom (detailed options below).</p>

            <div id="extrasContainer">
                <!-- Extras will be dynamically added here -->
            </div>
            
            <div class="form-group">
                <button type="button" class="export-btn" onclick="addExtra()" style="font-size: 0.9em; padding: 10px 20px;">Add New Extra</button>
            </div>
        </div>

        <!-- Character Summary -->
        <div class="section">
            <h2>Character Summary</h2>
            <div id="characterSummary">
                <p>Select heritage, skills, and powers to see your character summary.</p>
            </div>
        </div>

        <!-- Export -->
        <div class="export-section">
            <button class="export-btn" onclick="exportCharacter()">Export Character</button>
            <button class="reset-btn" onclick="resetCharacter()">Reset All</button>
            <button class="export-btn" onclick="testLocalStorage()" style="font-size: 0.8em; padding: 8px 16px; margin-left: 15px;">Test Save/Load</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>